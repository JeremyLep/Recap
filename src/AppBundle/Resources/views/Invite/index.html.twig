{% extends "AppBundle::layout.html.twig" %}

{% block titre %}
  <a class="navbar-brand" href="{{ path('app_home') }}">Mes invitations</a> 
{% endblock %}

{% block groupe %}
{% endblock %}
{% block invite %}
{{ render(controller('AppBundle:Default:menuTop')) }}
{% endblock %}

{% block body %}
<div id="content" class="col-12">
    <div class="col-sm-10 offset-sm-1">
        <h2 class="mt-5 mb-5">Vos invitations</h2>
        <div class="row p-2" id="membre" style=" border-right: .25rem solid transparent;">
          <table class="table table-striped table-hover">
            <thead>
              <tr>
                <th>Invit√© par</th>
                <th>Groupe</th>
                <th>E-mail</th>
                <th>Date</th>
                <th>Date d'expiration</th>
                <th>Etat</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
            {% for invite in invites %}
              <tr>
                <td>{{ invite.auteur.username }}</td>
                <td>{{ invite.groupe.titre }}</td>
                <td>{{ invite.email }}</td>
                <td>{{ invite.date|date('d/m/y H:i:s') }}</td>
                <td>{{ invite.dateExpiration|date('d/m/y H:i:s') }}</td>
                <td>{{ invite.active }}
                </td>
                <td>
                {% if invite.active == "En attente" %}
                  <button id="confirm" data-confirm="true" data-invite="{{ invite.id }}" type="button" class="btn btn-defaut-inv">Accepter</button>
                  <button id="confirm" data-confirm="false" data-invite="{{ invite.id }}" type="button" class="btn btn-danger">Refuser</button>
                {% endif %}
                </td>
                
              </tr>
            {% endfor %}
            </tbody>
          </table>
        </div>
    </div>
</div>
{% endblock %}


{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript">
      $(document).on("click", "#confirm", function() {
        $.ajax({
            url: '{{ path("app_invite_confirm") }}',
            type: 'POST',
            data: { id : $(this).attr('data-invite'), confirm : $(this).attr('data-confirm')},
            success: function(success) {
              $('html').html( success );
            }
        });
      });

    </script>
{% endblock %}