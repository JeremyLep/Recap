{% extends "AppBundle::layout.html.twig" %}

{% block titre %}
  <a class="navbar-brand" href="{{ path('app_groupe', {'id_groupe': groupe.id}) }}">{{ groupe.titre }}</a> 
  {% if groupe.avatar == null %}
    <span class="default-avatar m-0 hidden-xs" style="background-color: {{ groupe.color  }};">{{ groupe.titre|first|upper }}</span>
  {% else %}
    <img src="{{ asset('bundles/app/avatar/'~ groupe.avatar) }}" class="img-fluid rounded mt-2 text-right hidden-xs" alt="avatar" style="max-width: 35px; max-height: 35px;">
  {% endif %}
{% endblock %}

{% block groupe %}
  <li class="nav-item li-inline" id="fiche-icon">
    <a class="nav-link" href="{{ path('app_groupe', {'id_groupe': groupe.id} ) }}">{{ groupe.nbFiche }}  <i class="fa fa-file-text-o" aria-hidden="true"></i></a>
  </li>
  <li class="nav-item li-inline" id="membre-list">
    <a class="nav-link" href="{{ path('app_membre', {'id_groupe': groupe.id}) }}">{{ groupe.nbMembre }}  <i class="fa fa-user-o" aria-hidden="true"></i></a>
  </li>
{% endblock %}

{% block body %}
<div class="row col-12 pt-2" id="menu-titre" style="border-bottom: .0625rem solid #e8e8e8;">
  <div class="p-3 m-0 col-6" style="font-size: 1.2rem;">{{ groupe.nbFiche }} fiches 
    {% if (membre.hasRole('ROLE_MODO') or membre.user.id == groupe.user.id) %}
    <a href="{{ path('app_fiche_add', {'id_groupe': groupe.id}) }}"  style="font-size: 0.8rem;"> Ajouter</a>
    {% endif %}
  </div>
  <div class="text-right pr-0 col-6">
    {% if (membre.hasRole('ROLE_MODO') or membre.user.id == groupe.user.id) %}
    <a class="btn btn-info p-3 rounded-0 h-100" href="{{ path('app_invite_add', {'groupeId': groupe.id}) }}"><i class="fa fa-envelope"></i> Inviter sur ce groupe</a>
    {% endif %}
  </div>
</div>

<div id="content" class="col-12">
  <div class="row p-1">

    {% for fiche in groupe.fiche %}
    
    <section class="col-xs-12 col-sm-12 col-md-6 col-lg-6 placeholders pt-3" id={{fiche.id}}>
      <a href="{{ path('app_fiche', {'id_fiche': fiche.id, 'id_groupe': groupe.id}) }}">
      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 placeholder">
          <div class="card card-fiche">
            <div class="card-header">
              <div class="row">
              <div class=" col-7 text-left">
                <h5>{{ fiche.theme }}</h5>
              </div>
              <div class=" col-5 text-right">
                <small class="">{{ fiche.countNote() }} votes</small>
                <h6 class="m-0 text-warning">
                {% for i in 1..5 %}
                    {% if fiche.averageNote() >= loop.index %}
                    <span class="fa fa-star"></span>
                    {% else %}
                    <span class="fa fa-star-o"></span>
                    {% endif %}
                  {% endfor %}
                </h6>
              </div>
            </div>
            <div class="row">
              <div class=" col-12 text-left">
                <p class="m-0" style="font-size: 0.9rem; ">Auteur: {{ fiche.auteur.user.nom }}</p>
              </div>
            </div>
            <div class="row">
              <div class=" col-12 text-left">
                <p class="m-0" style="font-size: 0.7rem; ">Difficulté : {{ fiche.difficulte }}  |  Durée : {{ fiche.duree }} </p>
              </div>
            </div>
            </div>
            <div class="card-block text-center">
              <h4 class="card-title pt-3">{{ fiche.titre}}</h4>
              <p class="card-text p-3">{{ fiche.description|length > 250 ? fiche.description|slice(0, 250) ~ '...' : fiche.description  }}</p>
            </div>
            <div class="card-footer text-muted">
              <div class="row">
                <h6 class="col-5 text-left m-0 pr-0">{{ fiche.nbCommentaire }} commentaires</h6>
                <h6 class="col-7 m-0 text-right text-white">

                {% for tag in fiche.getTag() %}
                  <span class="badge badge-color" style="background-color: {{ tag.color}};">{{ tag.label }}</span>
                {% endfor %}
                </h6>
              </div>
            </div>
          </div>
        </div>
      </div>
    </a>
    </section>
    
    {% endfor %}

   
  </div>

</div>

{% endblock %}